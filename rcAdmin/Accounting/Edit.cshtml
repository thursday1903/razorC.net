@{
    //Get Account ID
    var accId = Request["aid"];
    var errMSG = "";

    //Lấy thông tin chi tiết account
    var db = Database.Open("Checking_Master");
    var sqlSelect = " Select * from dbo.Accounting where Id_Accounting=@0";
    var data = db.QuerySingle(sqlSelect, accId);
    var accountName = data.Account_Name;
    var contactPerson = data.Contact_Person;
    var country = data.Id_Country;

    //Load dữ liệu combo box
    var sqlCountry = "SELECT Id_Country, Country_Name FROM Countries";
    var dbCountry = db.Query(sqlCountry);
    
    //Submit form
    if (IsPost)
    {
        if (!Request["btnUpdate"].IsEmpty())
        {
            accountName = Request["accountName"];
            contactPerson = Request["contactPerson"];
            country = Request["country"];
            
            String sql = "UPDATE [Accounting] " +
            "SET [Account_Name] = @0 " +
            ",[Id_Country] = @1 " +
            ",[Contact_Person] = @2 where Id_Accounting = " + accId;

            db.Execute(sql, accountName, country, contactPerson, accId);
            
            Response.Redirect("Index");
        }
    }
    
    db.Close();
}

@section menu
{
    @RenderPage("../_Menu.cshtml")
}

<form action="" method="POST" id="editPage">
    <fieldset>
        <legend>Edit Page | <a href="~/rcAdmin/Accounting/">All Account</a> | <a href="~/rcAdmin/Accounting/New.cshtml"></a></legend>
        <ol>
            <li>
                <label for="accountName">Account Name: </label>
                <input type="text" name="accountName" id="accountName" value="@accountName" maxlength="50"/>
            </li>
            <li>
                <label for="country">Country: </label>
                <select id="country" name="country" @Validation.For("country")>
                    @foreach(var c in dbCountry)
                    {
                        <option value="@c.Id_Country" @if(country == c.Id_Country){<text>selected="selected"</text>}>@c.Country_Name</option>
                    }
                </select>
            </li>
            <li>
                <label for="contactPerson">Contact Person: </label>
                <input type="text" name="contactPerson" id="contactPerson" value="@contactPerson" maxlength="50" @Validation.For("contactPerson")/> <img src="~/rcAdmin/Countries/images/help.gif" alt="help" title="Name of the new page. Ex.: about-us or contact-us" /> @Html.ValidationMessage("contactPerson")
            </li>
        </ol>
        <p class="form-actions">
            <input type="submit" value="Insert" title="Insert" name="btnUpdate"/>
        </p>
    </fieldset>
</form>